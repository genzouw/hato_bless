<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SSL のサポートについて</title><meta name="Language" content="ja-jp" /><meta name="System.Keywords" content="暗号化" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="073f3b9e-8edd-4815-88ea-de0655d0325e" /><meta name="Description" content="SQL Server に接続する際、アプリケーションが暗号化を要求し、なおかつ、SQL Server のインスタンスが SSL 暗号化をサポートする構成になっていた場合、Microsoft JDBC Driver for SQL Server は SSL ハンドシェイクを開始します。サーバーとクライアントは、このハンドシェイクによって、データの保護に使用する暗号化と暗号アルゴリズムをネゴシエートします。SSL ハンドシェイクが完了すると、暗号化されたデータを安全に送信できるようになります。サーバーは、SSL" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">SSL のサポートについて</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>SQL Server に接続する際、アプリケーションが暗号化を要求し、なおかつ、SQL Server のインスタンスが SSL 暗号化をサポートする構成になっていた場合、Microsoft JDBC Driver for SQL Server は SSL ハンドシェイクを開始します。サーバーとクライアントは、このハンドシェイクによって、データの保護に使用する暗号化と暗号アルゴリズムをネゴシエートします。SSL ハンドシェイクが完了すると、暗号化されたデータを安全に送信できるようになります。サーバーは、SSL ハンドシェイクの際にクライアントに公開キー証明書を送信します。公開キー証明書の発行者は証明機関 (CA) と呼ばれます。その証明機関が、クライアントが信頼するいずれかの証明機関に該当するかどうかは、クライアント側で検証する必要があります。</p><p>アプリケーションから暗号化を要求されなかった場合、SQL Server に、SSL 暗号化をサポートするよう Microsoft JDBC Driver for SQL Server が強制的に働きかけることはありません。SQL Server インスタンスが SSL 暗号化を強制的に使用するように構成されていない場合、接続は暗号化なしで確立されます。SQL Server インスタンスが SSL 暗号化を強制的に使用するように構成されている場合は、使用中の Java 仮想マシン (JVM) が正常に構成されていれば自動的に SSL 暗号化を有効にし、そうでなければ接続を終了してエラーを生成します。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SSL 接続に成功するためには、<span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> に渡された値が、サーバー証明書に含まれる Subject Alternate Name (SAN) の Common Name (CN) または DNS 名と厳密に一致している必要があります。</p></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL Server の SSL を構成する方法の詳細については、SQL Server オンライン ブックの「SQL Server への接続の暗号化」のトピックを参照してください。</p></div></div><h1 class="heading">解説</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>SSL 暗号化をアプリケーションが使用できるようにするために、Microsoft JDBC Driver for SQL Server のバージョン 1.2 リリース以降では、<span class="label">encrypt</span>、<span class="label">trustServerCertificate</span>、<span class="label">trustStore</span>、<span class="label">trustStorePassword</span>、<span class="label">hostNameInCertificate</span> の各接続プロパティが導入されました。詳細については、「<span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">接続プロパティの設定</a></span>」を参照してください。</p><p>次の表は、想定される SSL 接続シナリオでの Microsoft JDBC Driver for SQL Server バージョンの動作をまとめたものです。使用する SSL 接続プロパティの組み合わせをシナリオごとに変えています。表の値の意味を以下に示します。</p><ul><li><p><span sdata="langKeyword" value="blank"><span class="keyword">blank</span></span>: "接続文字列にプロパティが存在しない"</p></li><li><p><span sdata="langKeyword" value="value"><span class="keyword">value</span></span>: "接続文字列にプロパティが存在し、その値が有効である"</p></li><li><p><span sdata="langKeyword" value="any"><span class="keyword">any</span></span>: "接続文字列にプロパティが存在するかどうか、またはその値が有効であるかどうかは関係ない"</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL Server ユーザー認証でも Windows 統合認証でも同じ動作になります。</p></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>encrypt</p></th><th><p>trustServerCertificate</p></th><th><p>hostNameInCertificate</p></th><th><p>trustStore</p></th><th><p>trustStorePassword</p></th><th><p>動作</p></th></tr><tr><td><p>false または blank</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SSL 暗号化のサポートを SQL Server に強制しません。サーバーに自己署名証明書が存在する場合、その SSL 証明書の交換をドライバーは開始します。SSL 証明書の検証は行われず、(ログイン パケット内の) 資格情報のみが暗号化されます。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合は、SSL 証明書の交換が開始されます。SSL 証明書の検証は行われませんが、通信全体が暗号化されます。</p></td></tr><tr><td><p>true</p></td><td><p>true</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。<span class="label">trustServerCertificate</span> プロパティが "true" に設定されている場合は SSL 証明書の検証が行われないことに注意してください。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、接続 URL に指定されている <span class="label">serverName</span> プロパティを使用してサーバーの SSL 証明書を検証し、信頼マネージャー ファクトリの検索ルールに従って、使用する証明書ストアを決定します。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">hostNameInCertificate</span> プロパティに指定されている値を使用して、SSL 証明書のサブジェクトの値を検証します。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStore</span> プロパティの値を使用して証明書の trustStore ファイルを検索し、<span class="label">trustStorePassword</span> プロパティの値を使用して trustStore ファイルの整合性をチェックします。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStorePassword</span> プロパティの値を使用して、既定の trustStore ファイルの整合性をチェックします。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStore</span> プロパティの値を使用して、trustStore ファイルの場所を調べます。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>value</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStorePassword</span> プロパティの値を使用して、既定の trustStore ファイルの整合性をチェックします。また、<span class="label">hostNameInCertificate</span> プロパティの値を使用して、SSL 証明書を検証します。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>blank</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStore</span> プロパティの値を使用して、trustStore ファイルの場所を調べます。また、<span class="label">hostNameInCertificate</span> プロパティの値を使用して、SSL 証明書を検証します。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr><tr><td><p>true</p></td><td><p>false または blank</p></td><td><p>value</p></td><td><p>value</p></td><td><p>value</p></td><td><p>Microsoft JDBC Driver for SQL Server は、SQL Server に SSL 暗号化を使用するように要求します。</p><p>サーバーがクライアントに SSL 暗号化のサポートを要求している場合、またはサーバーが暗号化をサポートしている場合、ドライバーが SSL 証明書の交換を開始します。</p><p>ドライバーは、<span class="label">trustStore</span> プロパティの値を使用して証明書の trustStore ファイルを検索し、<span class="label">trustStorePassword</span> プロパティの値を使用して trustStore ファイルの整合性をチェックします。また、<span class="label">hostNameInCertificate</span> プロパティの値を使用して、SSL 証明書を検証します。</p><p>サーバーが暗号化をサポートするように構成されていない場合、ドライバーはエラーを生成して接続を終了します。</p></td></tr></table></div><p>encrypt プロパティが <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> に設定されている場合、Microsoft JDBC Driver for SQL Server は、JVM の既定の JSSE セキュリティ プロバイダーを使用して、SQL Server と SSL 暗号化をネゴシエートします。既定のセキュリティ プロバイダーでは、SSL 暗号化の正常なネゴシエートに必要なすべての機能がサポートされているとは限りません。たとえば、既定のセキュリティ プロバイダーでは、SQL Server の SSL 証明書で使用されている RSA 公開キーのサイズがサポートされていない場合があります。この場合、既定のセキュリティ プロバイダーでエラーが発生し、その結果 JDBC ドライバーが接続を終了する可能性があります。この問題を解決するには、次のいずれかを実行します。</p><ul><li><p>サイズの小さい RSA 公開キーを持つサーバー証明書を使用して、SQL Server を構成します。</p></li><li><p>&lt;java-home&gt;/lib/security/java.security セキュリティ プロパティ ファイルで、別の JSSE セキュリティ プロバイダーを使用するように JVM を構成します。</p></li><li><p>別の JVM を使用します。</p></li></ul></div><h1 class="heading">サーバーの SSL 証明書の検証</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>サーバーは、SSL ハンドシェイクの際にクライアントに公開キー証明書を送信します。そのサーバー証明書が、クライアントが信頼している証明機関によって発行されているかどうかを、JDBC ドライバーまたはクライアントが検証する必要があります。ドライバーは、サーバー証明書で次の条件が満たされている状態を必要とします。</p><ul><li><p>信頼されている証明機関から発行されている。</p></li><li><p>サーバー認証用に証明書が発行されている。</p></li><li><p>証明書の有効期限が切れていない。</p></li><li><p>証明書の Subject の Common Name (CN) または Subject Alternate Name (SAN) の DNS 名が、接続文字列に指定された <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> の値 (または <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span> プロパティの値が指定されている場合はその値) と厳密に一致している。</p></li><li><p>DNS 名にはワイルドカード文字を含めることができます。ただし、Microsoft JDBC Driver for SQL Server では、ワイルドカードでのマッチングがサポートされません。つまり、abc.com は *.com とは一致せず、*.com は *.com と一致します。</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">関連項目</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">SSL 暗号化の使用</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">JDBC ドライバー アプリケーションのセキュリティ保護</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">このトピックに関する<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dフィードバックありがとうございます。開発チームは、皆様からのフィードバックに基づいてドキュメントを改善しています。フィードバックを確認中、内容の確認または解決策に関するご意見をうかがうために電子メールをお送りする場合があります。お客様の電子メール アドレスをそれ以外の目的で使用することはありません。また、確認完了後はお客様の電子メール アドレス情報を削除させていただきます。%0\Aマイクロソフトのプライバシーに関する声明の詳細については、http://privacy.microsoft.com/ja-jp/default.aspx を参照してください。%0\A%0\d','カスタマー フィードバック');">フィードバック</a>を Microsoft にお送りください。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.All rights reserved.</a></p></span></div></div></body></html>