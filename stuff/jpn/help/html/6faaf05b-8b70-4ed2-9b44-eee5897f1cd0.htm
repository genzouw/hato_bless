<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>JDBC ドライバーの使用</title><meta name="Language" content="ja-jp" /><meta name="System.Keywords" content="JDBC ドライバーの概要, JDBC ドライバーの使用" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="このセクションでは、Microsoft JDBC Driver for SQL Server を使用して SQL Server データベースへの単純な接続を作成する方法について簡単に説明します。SQL Server データベースに接続する前に、まず SQL Server をローカル コンピューターまたはサーバーのどちらかにインストールし、JDBC ドライバーをローカル コンピューターにインストールする必要があります。 " /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">JDBC ドライバーの使用</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>このセクションでは、Microsoft JDBC Driver for SQL Server を使用して SQL Server データベースへの単純な接続を作成する方法について簡単に説明します。SQL Server データベースに接続する前に、まず SQL Server をローカル コンピューターまたはサーバーのどちらかにインストールし、JDBC ドライバーをローカル コンピューターにインストールする必要があります。 </p></div><h1 class="heading">適切な JAR ファイルの選択</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Microsoft JDBC Driver for SQL Server には、<span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> と <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span> という 2 つのクラス ライブラリ ファイルが用意されており、必要な Java ランタイム環境 (JRE) 設定によって自由に使い分けることができます。選択する JAR ファイルの詳細については、「<span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">JDBC Driver のシステム要件</a></span>」を参照してください。</p></div><h1 class="heading">クラスパスの設定</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>JDBC ドライバーは、Java SDK の一部ではありません。使用する場合は、クラスパスの設定で sqljdbc.jar ファイルまたは sqljdbc4.jar ファイルを追加する必要があります。クラスパスに sqljdbc.jar または sqljdbc4.jar のエントリがない場合、お使いのアプリケーションで "Class not found" という一般的な例外がスローされます。</p><p>sqljdbc.jar ファイルおよび sqljdbc4.jar ファイルは次の場所にインストールされます。</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>Windows アプリケーションで使用される CLASSPATH ステートメントの例を以下に示します。</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>Unix/Linux アプリケーションで使用される CLASSPATH ステートメントの例を以下に示します。</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>CLASSPATH ステートメントに指定する Microsoft JDBC Driver for SQL Server は 1 つだけとしてください (sqljdbc.jar または sqljdbc4.jar のどちらか一方など)。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Windows システムでは、ディレクトリ名が 8.3 より長い場合、またはフォルダー名にスペースが含まれている場合、クラスパスに問題が生じることがあります。この種の問題が疑われる場合、sqljdbc.jar ファイルまたは sqljdbc4.jar ファイルを一時的に<span class="code"> C:\Temp</span> のような単純な名前のディレクトリへ移動し、クラスパスを変更して問題が解決するかどうか判断する必要があります。</p></div><h1 class="heading">コマンド プロンプトで直接実行されるアプリケーション</h1><div class="subsection"><p>クラスパスは、オペレーティング システムにおいて構成されます。sqljdbc.jar または sqljdbc4.jar をシステムのクラスパスに追加します。または、<span class="code">java -classpath</span> オプションを使用して、アプリケーションを実行するクラスパスを Java コマンド ラインで指定することもできます。</p></div><h1 class="heading">IDE で実行されるアプリケーション</h1><div class="subsection"><p>各 IDE ベンダーでは、クラスパスを自社の IDE に設定するためのさまざまな方法を用意しています。クラスパスをオペレーティング システムに設定するだけでは動作しません。sqljdbc.jar または sqljdbc4.jar を IDE クラスパスに追加する必要があります。</p></div><h1 class="heading">サーブレットおよび JSP</h1><div class="subsection"><p>サーブレットや JSP は、Tomcat のようなサーブレット/JSP エンジンで実行されます。クラスパスは、サーブレット/JSP エンジンのドキュメントに従って設定する必要があります。クラスパスをオペレーティング システムに設定するだけでは動作しません。一部のサーブレット/JSP エンジンでは、エンジンのクラスパスを設定するために使用できるセットアップ画面が用意されています。この場合、正しい JDBC ドライバー用 JAR ファイルを既存のエンジン クラスパスに追加し、エンジンを再起動する必要があります。この他の場合は、エンジンをインストールするときに lib のような特定のディレクトリに sqljdbc.jar または sqljdbc4.jar をコピーしてドライバーを配置することができます。エンジン ドライバーのクラスパスは、エンジン固有の構成ファイルで指定することもできます。</p></div><h1 class="heading">Enterprise Java Beans</h1><div class="subsection"><p>Enterprise Java Beans (EJB) は、EJB コンテナーで実行されます。EJB コンテナーは、さまざまなベンダーから供給されています。Java アプレットはブラウザー上で動作しますが、Web サーバーからダウンロードされます。sqljdbc.jar または sqljdbc4.jar を Web サーバーのルートにコピーし、アプレットの [HTML archive] タブで JAR ファイル名を指定します。たとえば <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span> のようになります。</p></div></div><h1 class="heading">データベースへの簡単な接続を作成する</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>sqljdbc.jar クラス ライブラリを使用するアプリケーションでは、まず次のようにしてドライバーを登録する必要があります。</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>ドライバーが読み込まれたら、接続 URL および <b>DriverManager</b> クラスの <b>getConnection</b> メソッドを使用して接続を確立します。</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>JDBC API 4.0 では、JDBC ドライバーが自動的に読み込まれるように、<b>DriverManager.getConnection</b> メソッドが改良されました。したがって、sqljdbc4.jar クラス ライブラリを使用する場合は、アプリケーションから <b>Class.forName</b> メソッドを呼び出してドライバーの登録または読み込みを行う必要はありません。</p><p><b>DriverManager</b> クラスの <b>getConnection</b> メソッドを呼び出すと、登録されている一連の JDBC ドライバーから適切なドライバーが検出されます。sqljdbc4.jar ファイルには、"META-INF/services/java.sql.Driver" ファイルが含まれており、そこに登録済みのドライバーとして <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span> が存在します。現在 <b>Class.forName</b> メソッドを使用してドライバーを読み込む仕様になっている既存のアプリケーションも正常に動作します。特に修正の必要はありません。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>sqljdbc4.jar クラス ライブラリを使用するには、バージョン 6.0 以降の Java ランタイム環境 (JRE) が必要です。</p></div><p>データ ソースとの接続および接続 URL の使用の詳細については、「<span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">接続 URL の構築</a></span>」および「<span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">接続プロパティの設定</a></span>」を参照してください。</p></div><span id="seeAlsoSpan"><h1 class="heading">関連項目</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">JDBC ドライバーの概要</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">このトピックに関する<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dフィードバックありがとうございます。開発チームは、皆様からのフィードバックに基づいてドキュメントを改善しています。フィードバックを確認中、内容の確認または解決策に関するご意見をうかがうために電子メールをお送りする場合があります。お客様の電子メール アドレスをそれ以外の目的で使用することはありません。また、確認完了後はお客様の電子メール アドレス情報を削除させていただきます。%0\Aマイクロソフトのプライバシーに関する声明の詳細については、http://privacy.microsoft.com/ja-jp/default.aspx を参照してください。%0\A%0\d','カスタマー フィードバック');">フィードバック</a>を Microsoft にお送りください。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.All rights reserved.</a></p></span></div></div></body></html>