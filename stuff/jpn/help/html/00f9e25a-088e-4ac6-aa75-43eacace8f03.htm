<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SQL エスケープ シーケンスの使用</title><meta name="Language" content="ja-jp" /><meta name="System.Keywords" content="SQL エスケープ シーケンス" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="Microsoft JDBC Driver for SQL Server では、JDBC API で定義された SQL エスケープ シーケンスを使用することができます。SQL ステートメント内のエスケープ シーケンスは、SQL 文字列のエスケープ部分を異なる方法で処理することを、JDBC ドライバーに指示するために使用します。JDBC ドライバーが SQL 文字列のエスケープ部分を処理すると、文字列の該当部分は SQL Server が理解する SQL コードに変換されます。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">SQL エスケープ シーケンスの使用</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Microsoft JDBC Driver for SQL Server では、JDBC API で定義された SQL エスケープ シーケンスを使用することができます。SQL ステートメント内のエスケープ シーケンスは、SQL 文字列のエスケープ部分を異なる方法で処理することを、JDBC ドライバーに指示するために使用します。JDBC ドライバーが SQL 文字列のエスケープ部分を処理すると、文字列の該当部分は SQL Server が理解する SQL コードに変換されます。</p><p>JDBC API で要求されるエスケープ シーケンスには 5 つの種類があり、すべて JDBC ドライバーによってサポートされています。</p><ul><li><p>LIKE ワイルドカード リテラル</p></li><li><p>関数処理</p></li><li><p>日付および時刻のリテラル</p></li><li><p>ストアド プロシージャ呼び出し</p></li><li><p>外部結合</p></li></ul><p>JDBC ドライバーで使用されるエスケープ シーケンスの構文は、次のとおりです。</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL のエスケープ処理は、JDBC ドライバーに対して常に有効化されています。</p></div><p>以下のセクションでは、5 つの種類のエスケープ シーケンスと、それらが JDBC ドライバーでどのようにサポートされているかについて説明します。</p></div><h1 class="heading">LIKE ワイルドカード リテラル</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>JDBC ドライバーは、LIKE 句でワイルドカードをリテラルとして使用する <span class="code">{escape 'escape character'}</span> 構文をサポートします。たとえば次のコードでは、col2 の値が (ワイルドカードとしてではなく) 文字どおりアンダースコアで始まっている行の col3 の値が返されます。</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>エスケープ シーケンスは、SQL ステートメントの末尾に置く必要があります。コマンド文字列内に複数の SQL ステートメントがある場合、エスケープ シーケンスは該当する各 SQL ステートメントの末尾に置く必要があります。</p></div></div><h1 class="heading">関数処理</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>JDBC ドライバーは、次の構文で SQL ステートメント内の関数エスケープ シーケンスをサポートしています。</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p><span class="code">functionName</span> は、JDBC ドライバーでサポートされている関数です。次に例を示します。</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>次の表は、JDBC ドライバーで関数エスケープ シーケンスを使用する場合にサポートされている、さまざまな関数を示します。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>文字列関数</p></th><th><p>数値関数</p></th><th><p>日付時刻関数</p></th><th><p>システム関数</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>データベースでサポートされていない関数を使用すると、エラーが発生します。</p></div></div><h1 class="heading">日付および時刻のリテラル</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>日付、時刻、およびタイムスタンプのリテラルに使用するエスケープ構文は、次のとおりです。</p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>ここで <span class="code">literal-type</span> は、次のいずれかです。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>リテラルの種類</p></th><th><p>説明</p></th><th><p>値の形式</p></th></tr><tr><td><p>d</p></td><td><p>日付</p></td><td><p>yyyy-mm-dd</p></td></tr><tr><td><p>t</p></td><td><p>時刻</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>タイムスタンプ</p></td><td><p>yyyy-mm-dd hh:mm:ss[.f...]</p></td></tr></table></div><p>次に例を示します。</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">ストアド プロシージャ呼び出し</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>JDBC ドライバーでは、ストアド プロシージャ呼び出しについては、戻りパラメーターを処理する必要があるかどうかによって、<span class="code">{? = call proc_name(?,...)}</span> および <span class="code">{call proc_name(?,...)}</span> というエスケープ構文がサポートされています。</p><p>プロシージャは、データベースに格納されている実行可能なオブジェクトです。これは通常、プリコンパイルされた 1 つ以上の SQL ステートメントです。ストアド プロシージャを呼び出すためのエスケープ シーケンス構文は、次のとおりです。</p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p><span class="code">procedure-name</span> にはストアド プロシージャの名前を指定し、<span class="code">parameter</span> にはストアド プロシージャのパラメーターを指定します。</p><p>ストアド プロシージャで <span class="code">call</span> エスケープ シーケンスを使用する方法の詳細については、「<span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">ストアド プロシージャでのステートメントの使用</a></span>」を参照してください。</p></div><h1 class="heading">外部結合</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>JDBC ドライバーでは、SQL92 の左外部結合、右外部結合、および完全外部結合で使用する構文がサポートされています。外部結合用のエスケープ シーケンスは、次のとおりです。</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>outer-join の内容は次のとおりです。</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p><span class="code">table-reference</span> はテーブル名で、<span class="code">search-condition</span> はテーブルで使用する結合条件です。</p><p>次に例を示します。</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>JDBC ドライバーでは、次の外部結合エスケープ シーケンスがサポートされています。</p><ul><li><p>左外部結合</p></li><li><p>右外部結合</p></li><li><p>完全外部結合</p></li><li><p>入れ子になった外部結合</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">関連項目</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">JDBC ドライバーでのステートメントの使用</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">このトピックに関する<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dフィードバックありがとうございます。開発チームは、皆様からのフィードバックに基づいてドキュメントを改善しています。フィードバックを確認中、内容の確認または解決策に関するご意見をうかがうために電子メールをお送りする場合があります。お客様の電子メール アドレスをそれ以外の目的で使用することはありません。また、確認完了後はお客様の電子メール アドレス情報を削除させていただきます。%0\Aマイクロソフトのプライバシーに関する声明の詳細については、http://privacy.microsoft.com/ja-jp/default.aspx を参照してください。%0\A%0\d','カスタマー フィードバック');">フィードバック</a>を Microsoft にお送りください。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.All rights reserved.</a></p></span></div></div></body></html>