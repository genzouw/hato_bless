<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>SSL 暗号化のためのクライアントの構成</title><meta name="Language" content="ja-jp" /><meta name="System.Keywords" content="証明書" /><meta name="System.Keywords" content="SSL 証明書の構成" /><meta name="System.Keywords" content="SSL" /><meta name="System.Keywords" content="SSL 証明書" /><meta name="Microsoft.Help.Id" content="ae34cd1f-3569-4759-80c7-7c9b33b3e9eb" /><meta name="Description" content="Microsoft JDBC Driver for SQL Server またはクライアントでは、サーバーが正しいサーバーであること、およびクライアントが信頼している証明機関から証明書が発行されていることを確認する必要があります。サーバー証明書を検証するには、接続時にトラスト マテリアルを提供する必要があります。また、サーバー証明書の発行者が、クライアントによって信頼されている証明機関である必要があります。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">SSL 暗号化のためのクライアントの構成</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Microsoft JDBC Driver for SQL Server またはクライアントでは、サーバーが正しいサーバーであること、およびクライアントが信頼している証明機関から証明書が発行されていることを確認する必要があります。サーバー証明書を検証するには、接続時にトラスト マテリアルを提供する必要があります。また、サーバー証明書の発行者が、クライアントによって信頼されている証明機関である必要があります。</p><p>このトピックでは、まず、クライアント コンピューターのトラスト マテリアルを提供する方法を説明します。次に、SQL Server のインスタンスの SSL (Secure Sockets Layer) 証明書が民間の証明機関によって発行されている場合にサーバー証明書をクライアント コンピューターのトラスト ストアにインポートする方法を説明します。</p><p>サーバー証明書の検証の詳細については、「<span sdata="link"><a href="073f3b9e-8edd-4815-88ea-de0655d0325e.htm">SSL のサポートについて</a></span>」の「サーバーの SSL 証明書の検証」を参照してください。</p></div><h1 class="heading">クライアントのトラスト ストアの構成</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>サーバー証明書を検証するには、<span class="label">trustStore</span> 接続プロパティと <span class="label">trustStorePassword</span> 接続プロパティを明示的に使用するか、または基になる Java 仮想マシンのトラスト ストアを暗黙的に使用して、接続時にトラスト マテリアルを提供する必要があります。接続文字列内に <span class="label">trustStore</span> プロパティと <span class="label">trustStorePassword</span>  プロパティを設定する方法の詳細については、「<span sdata="link"><a href="ec91fa8a-ab7e-4c1e-a05a-d7951ddf33b1.htm">SSL 暗号化を使用した接続</a></span>」を参照してください。</p><p><span class="label">trustStore</span> プロパティが指定されていないか null に設定されている場合、Microsoft JDBC Driver for SQL Server では、基になる JVM のセキュリティ プロバイダー Java Secure Socket Extension (SunJSSE) を信頼します。によって提供される既定の <b>TrustManager</b> を使用して、SQL Server から返される X.509 証明書を、トラスト ストアで提供されるトラスト マテリアルに対して検証します。</p><p><b>TrustManager</b> は、次の順序で既定の trustStore を検索します。</p><ul><li><p>システム プロパティ "javax.net.ssl.trustStore" が定義されている場合、<b>TrustManager</b> は、そのシステム プロパティによって指定されているファイル名を使用して既定の trustStore ファイルを見つけようとします。</p></li><li><p>"javax.net.ssl.trustStore" システム プロパティが指定されていない場合に、ファイル "&lt;java-home&gt;/lib/security/jssecacerts" が存在する場合は、そのファイルが使用されます。</p></li><li><p>ファイル "&lt;java-home&gt;/lib/security/cacerts" が存在する場合は、そのファイルが使用されます。</p></li></ul><p>詳細については、Sun Microsystems の Web サイトで SunX509 TrustManager Interface についてのドキュメントを参照してください。</p><p>Java ランタイム環境では、次のようにしてシステム プロパティ trustStore および trustStorePassword を設定できます。</p><div class="sampleCode"><span codeLanguage="other"><pre>java -Djavax.net.ssl.trustStore=C:\MyCertificates\storeName
java -Djavax.net.ssl.trustStorePassword=storePassword</pre></span></div><p>この場合、この JVM 上で実行されるすべてのアプリケーションが既定でこれらの設定を使用します。アプリケーションでこの既定の設定をオーバーライドするには、接続文字列か、<a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a> クラスの該当する setter メソッドで、接続プロパティの <span class="label">trustStore</span> および <span class="label">trustStorePassword</span> を設定する必要があります。</p><p>これ以外に、"&lt;java-home&gt;/lib/security/jssecacerts" や "&lt;java-home&gt;/lib/security/cacerts" など、既定のトラスト ストア ファイルを構成および管理することもできます。そのためには、JRE (Java ランタイム環境) と共にインストールされる JAVA "keytool" ユーティリティを使用します。"keytool" ユーティリティの詳細については、Sun Microsystems の Web サイトで keytool についてのドキュメントを参照してください。</p><h1 class="heading">トラスト ストアへのサーバー証明書のインポート</h1><div class="subsection"><p>サーバーは、SSL ハンドシェイクの際にクライアントに公開キー証明書を送信します。公開キー証明書の発行者は証明機関 (CA) と呼ばれます。クライアントは、その証明機関が信頼されている証明機関であることを確認する必要があります。この確認は、信頼されている CA の公開キーを事前に把握しておくことによって行われます。通常、JVM では、一連の信頼されている証明機関があらかじめ定義されています。</p><p>SQL Server のインスタンスの SSL 証明書が私的な証明機関によって発行されている場合は、クライアント コンピューターのトラスト ストアの信頼された証明書の一覧にその証明機関の証明書を追加する必要があります。</p><p>そのためには、JRE (Java ランタイム環境) と共にインストールされる JAVA "keytool" ユーティリティを使用します。次のコマンド プロンプトは、"keytool" ユーティリティを使用してファイルから証明書をインポートする方法を示しています。</p><div class="sampleCode"><span codeLanguage="other"><pre>keytool -import -v -trustcacerts -alias myServer -file caCert.cer -keystore truststore.ks</pre></span></div><p>この例では、"caCert.cer" というファイルが証明書ファイルとして使用されています。この証明書ファイルをサーバーから入手する必要があります。次の手順は、サーバー証明書をファイルにエクスポートする方法を示しています。</p><ol><li><p>[スタート] ボタンをクリックし、[ファイル名を指定して実行] をクリックして「MMC」と入力します (MMC は Microsoft 管理コンソールの略称です)。</p></li><li><p>MMC で、[証明書] を開きます。</p></li><li><p>[個人用] を展開し、[証明書] を展開します。</p></li><li><p>サーバー証明書を右クリックし、[すべてのタスク] をポイントして、[エクスポート] をクリックします。</p></li><li><p>証明書のエクスポート ウィザードの [ようこそ] ダイアログ ボックスで、[次へ] をクリックして次のページに進みます。</p></li><li><p>[いいえ、秘密キーをエクスポートしません] が選択されていることを確認して、[次へ] をクリックします。</p></li><li><p>[DER encoded binary X.509 (.CER)] または [Base-64 encoded X.509 (.CER)] が選択されていることを確認して、[次へ] をクリックします。</p></li><li><p>エクスポート ファイルの名前を入力します。</p></li><li><p>[次へ] をクリックし、[完了] をクリックすると、証明書がエクスポートされます。</p></li></ol></div></div><span id="seeAlsoSpan"><h1 class="heading">関連項目</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">SSL 暗号化の使用</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">JDBC ドライバー アプリケーションのセキュリティ保護</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">このトピックに関する<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dフィードバックありがとうございます。開発チームは、皆様からのフィードバックに基づいてドキュメントを改善しています。フィードバックを確認中、内容の確認または解決策に関するご意見をうかがうために電子メールをお送りする場合があります。お客様の電子メール アドレスをそれ以外の目的で使用することはありません。また、確認完了後はお客様の電子メール アドレス情報を削除させていただきます。%0\Aマイクロソフトのプライバシーに関する声明の詳細については、http://privacy.microsoft.com/ja-jp/default.aspx を参照してください。%0\A%0\d','カスタマー フィードバック');">フィードバック</a>を Microsoft にお送りください。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.All rights reserved.</a></p></span></div></div></body></html>