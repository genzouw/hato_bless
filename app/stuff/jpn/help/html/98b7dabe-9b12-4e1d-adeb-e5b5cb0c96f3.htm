<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>同時実行制御について</title><meta name="Language" content="ja-jp" /><meta name="System.Keywords" content="同時実行" /><meta name="Microsoft.Help.Id" content="98b7dabe-9b12-4e1d-adeb-e5b5cb0c96f3" /><meta name="Description" content="同時実行制御とは、複数のユーザーが同時に行を更新しているときにデータベースの整合性を維持するために使用される、さまざまな手法を表します。不適切な同時実行は、ダーティ リード、ファントム読み取り、反復不能読み取りなどの問題につながります。Microsoft JDBC Driver for SQL Server は、これらの問題を解決するために SQL Server によって使用されるすべての同時実行手法へのインターフェイスを提供します。" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">同時実行制御について</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>同時実行制御とは、複数のユーザーが同時に行を更新しているときにデータベースの整合性を維持するために使用される、さまざまな手法を表します。不適切な同時実行は、ダーティ リード、ファントム読み取り、反復不能読み取りなどの問題につながります。Microsoft JDBC Driver for SQL Server は、これらの問題を解決するために SQL Server によって使用されるすべての同時実行手法へのインターフェイスを提供します。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>SQL Server の同時実行の詳細については、SQL Server オンライン ブックの「同時実行データ アクセスの管理」を参照してください。</p></div></div><h1 class="heading">解説</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>JDBC ドライバーは、以下に示す同時実行の種類をサポートしています。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>同時実行の種類</p></th><th><p>特性</p></th><th><p>行ロック</p></th><th><p>説明</p></th></tr><tr><td><p>CONCUR_READ_ONLY</p></td><td><p>読み取り専用</p></td><td><p>しない</p></td><td><p>カーソルを使用して更新することはできません。また、結果セットを構成する行にはロックが設定されません。</p></td></tr><tr><td><p>CONCUR_UPDATABLE</p></td><td><p>オプティミスティック読み取り、書き込み</p></td><td><p>しない</p></td><td><p>データベースで、行の競合が発生する可能性が低いと想定されます。行の整合性は、タイムスタンプの比較によって検証されます。</p></td></tr><tr><td><p>CONCUR_SS_SCROLL_LOCKS</p></td><td><p>ペシミスティック読み取り、書き込み</p></td><td><p>する</p></td><td><p>データベースで、行の競合が発生する可能性が高いと想定されます。行の整合性は、行のロックによって保証されます。</p></td></tr><tr><td><p>CONCUR_SS_OPTIMISTIC_CC</p></td><td><p>オプティミスティック読み取り、書き込み</p></td><td><p>しない</p></td><td><p>データベースで、行の競合が発生する可能性が低いと想定されます。行の整合性は、タイムスタンプの比較によって検証されます。</p><p>SQL Server 2005 以降の場合、テーブルにタイムスタンプ列が含まれていなければ、サーバーはこの同時実行の種類を CONCUR_SS_OPTIMISTIC_CCVAL に変更します。</p><p>SQL Server 2000 の場合、基になるテーブルにタイムスタンプ列があれば、OPTIMISTIC WITH VALUES が指定されていても、OPTIMISTIC WITH ROW VERSIONING が使用されます。OPTIMISTIC WITH ROW VERSIONING が指定されていて、テーブルにタイムスタンプがない場合は、OPTIMISTIC WITH VALUES が使用されます。</p></td></tr><tr><td><p>CONCUR_SS_OPTIMISTIC_CCVAL</p></td><td><p>オプティミスティック読み取り、書き込み</p></td><td><p>しない</p></td><td><p>データベースで、行の競合が発生する可能性が低いと想定されます。行の整合性は、行データの比較によって検証されます。</p></td></tr></table></div></div><h1 class="heading">更新不可能な結果セット</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>更新可能な結果セットは、行の挿入、更新、および削除が可能な結果セットです。次の場合、SQL Server は更新可能なカーソルを作成できません。"結果セットは更新可能ではありません" という意味の例外が生成されます。</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>原因</p></th><th><p>説明</p></th><th><p>対処法</p></th></tr><tr><td><p>ステートメントが JDBC 2.0 (以降) の構文を使用して作成されていない</p></td><td><p>JDBC 2.0 では、ステートメントを作成するための新しい方法が導入されました。JDBC 1.0 の構文を使用した場合、結果セットは既定で読み取り専用になります。</p></td><td><p>ステートメントを作成するときに、結果セットの種類と同時実行を指定します。</p></td></tr><tr><td><p>ステートメントが TYPE_SCROLL_INSENSITIVE を使用して作成されている</p></td><td><p>SQL Server は、静的スナップショット カーソルを作成します。このカーソルは、他のユーザーによる行の更新からカーソルを保護するために、基になるテーブル行から切り離されています。</p></td><td><p>TYPE_SCROLL_SENSITIVE、TYPE_SS_SCROLL_KEYSET、TYPE_SS_SCROLL_DYNAMIC、または TYPE_FORWARD_ONLY を CONCUR_UPDATABLE と共に使用し、静的カーソルが作成されないようにします。</p></td></tr><tr><td><p>テーブル デザインにより KEYSET カーソルまたは DYNAMIC カーソルが使用できなくなっている</p></td><td><p>基になるテーブルに、SQL Server が行を一意に識別できる一意キーがありません。</p></td><td><p>一意キーをテーブルに追加し、各行を一意に識別できるようにします。</p></td></tr></table></div></div><span id="seeAlsoSpan"><h1 class="heading">関連項目</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="9ed5ad41-22e0-4e4a-8a79-10512db60d50.htm">JDBC ドライバーによる結果セットの管理</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">このトピックに関する<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dフィードバックありがとうございます。開発チームは、皆様からのフィードバックに基づいてドキュメントを改善しています。フィードバックを確認中、内容の確認または解決策に関するご意見をうかがうために電子メールをお送りする場合があります。お客様の電子メール アドレスをそれ以外の目的で使用することはありません。また、確認完了後はお客様の電子メール アドレス情報を削除させていただきます。%0\Aマイクロソフトのプライバシーに関する声明の詳細については、http://privacy.microsoft.com/ja-jp/default.aspx を参照してください。%0\A%0\d','カスタマー フィードバック');">フィードバック</a>を Microsoft にお送りください。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft.All rights reserved.</a></p></span></div></div></body></html>